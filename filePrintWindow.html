<!DOCTYPE html>
<html>
<head>
    <link href="./css/chap.css" rel="stylesheet" type="text/css"/>
</head>
<style>
    @page {
        size: A5 landscape;
    }

    @font-face {
        font-family: IRANSans-Light;
        src: url("./fonts/IRANSans-Light.eot") format('eot'),
        url("./fonts/IRANSans-Light.woff") format('woff'),
        url("./fonts/IRANSans-Light.ttf") format('truetype');
    }

    html {
        /*height: 8.27in;*/
        /*width: 5.83in;*/
        overflow: hidden;
    }

    body {
        background-image: url("./img/gilan-file-tahmasebi-25--3-1400-1@1x.png");
        background-repeat: no-repeat;
        background-size: cover;
        overflow: hidden;
    }

    body div {
        font-family: IRANSansMobileFaNum-Light;
        overflow: hidden;
    }
</style>
<!-- Set "A5", "A4" or "A3" for class name -->
<!-- Set also "landscape" if you need -->
<body id="btn-convert-pdf">
<div class="rectangle-186" id="owner" style="top: 80px; left: 620px"></div>
<div class="rectangle-187" id="telephone" style="top: 80px; left: 440px"></div>
<div class="rectangle-188" id="publisher" style="top: 80px; left: 305px"></div>
<div class="rectangle-189" id="number"></div>
<div class="rectangle-190" id="date"></div>
<div class="rectangle-191" id="regionCode" style="left: 165px"></div>
<div class="rectangle-192" id="regionName"></div>
<div class="rectangle-193" id="address" style="top: 125px"></div>
<div class="rectangle-194" id="mored" style="left: 780px; top: 210px; width: 50px"></div>
<div class="rectangle-195" id="noeMelk" style="left: 610px; top: 210px; width: 80px"></div>
<div class="rectangle-196" id="unitBuiltUpArea" style="left: 535px; top: 210px; width: 50px"></div>
<div class="rectangle-197" id="unitRoom" style="left: 460px; top: 210px; width: 50px"></div>
<div class="rectangle-198" id="unitFloor" style="left: 390px; top: 210px; width: 50px"></div>
<div class="rectangle-199" id="floorNo" style="left: 310px; top: 210px; width: 50px"></div>
<div class="rectangle-200" id="unitNo" style="left: 240px; top: 210px; width: 50px"></div>
<div class="rectangle-201" id="ageBuilding" style="left: 160px;top: 210px; width: 50px"></div>
<div class="rectangle-202" id="area" style="top: 210px"></div>
<div class="rectangle-203" id="front" style="top: 210px"></div>
<div class="rectangle-204" id="totalPrice" style="left: 600px; top: 250px"></div>
<div class="rectangle-205" id="unitPrice" style="left: 420px; top: 250px"></div>
<div class="rectangle-206" id="mortgagePrice" style="top: 250px"></div>
<div class="rectangle-207" id="rentPrice" style="top: 250px"></div>
<div class="rectangle-208" id="kabinet" style="left: 720px; top: 330px"></div>
<div class="rectangle-209" id="unitFloorCovering" style="left: 600px; top: 330px"></div>
<div class="rectangle-210" id="unitWC" style="left: 480px; top: 330px"></div>
<div class="rectangle-211" id="frontKind" style="left: 360px; top: 330px"></div>
<div class="rectangle-212" id="parking" style="top: 330px"></div>
<div class="rectangle-213" id="documentKind" style="top: 330px"></div>
<div class="rectangle-214" id="direction" style="top: 330px"></div>
<div class="rectangle-215" id="asansor" style="left: 730px; top: 375px"></div>
<div class="rectangle-216" id="anbari" style="left: 613px; top: 375px"></div>
<div class="rectangle-217" id="komodDivari" style="left: 495px; top: 375px"></div>
<div class="rectangle-218" id="kaghazDivari" style="left: 375px; top: 375px"></div>
<div class="rectangle-219" id="remoteDoor" style="left: 255px; top: 375px"></div>
<div class="rectangle-220" id="securityDoor" style="top: 375px"></div>
<div class="rectangle-221" id="iphoneImage" style="top: 375px"></div>
<div class="rectangle-222" id="shoofazh" style="left: 730px; top: 415px"></div>
<div class="rectangle-223" id="shoomine" style="left: 613px; top: 415px"></div>
<div class="rectangle-224" id="package" style="left: 495px; top: 415px"></div>
<div class="rectangle-225" id="gazRoomizi" style="left: 375px; top: 415px"></div>
<div class="rectangle-226" id="hood" style="left: 255px; top: 415px"></div>
<div class="rectangle-227" id="koolerGazi" style="top: 415px"></div>
<div class="rectangle-228" id="split" style="top: 415px"></div>
<div class="rectangle-229" id="hasTelephon" style="left: 730px; top: 455px"></div>
<div class="rectangle-230" id="doubleGlazedWindow" style="left: 613px; top: 455px"></div>
<div class="rectangle-231" id="pool" style="left: 495px; top: 455px"></div>
<div class="rectangle-232" id="balcony" style="left: 375px; top: 455px"></div>
<div class="rectangle-233" id="yard" style="left: 255px; top: 455px"></div>
<div class="rectangle-234" id="ownerInHouse" style="top: 455px"></div>
<div class="rectangle-235" id="takhlie" style="top: 455px"></div>
<div class="rectangle-236" id="comment" style="top: 500px"></div>
<div class="rectangle-237" id="receiver" style="top: 540px"></div>
</body>
<script>
    const electron = require('electron');
    const {ipcRenderer} = electron;
    const _ = require('underscore');
    const StringUtils = require('./utils/StringUtils');
    ipcRenderer.send('getPrintFile');
    const { remote } = require('electron');
    const { Menu } = remote;
    const Store = require('electron-store');
    const store = new Store();
    let filePrinted = undefined;

    const markdownContextMenu = Menu.buildFromTemplate([
        { type: 'separator' },
        { label: 'Cut', role: 'cut' },
        { label: 'Copy', role: 'copy' },
        { label: 'Paste', role: 'paste' },
        { label: 'Select All', role: 'selectall' },
    ]);

    document.addEventListener('contextmenu', (event) => {
        event.preventDefault();
        markdownContextMenu.popup();
    });

    function getDirection(file) {
        if (file.north) {
            return ('شمالی')
        } else if (file.south) {
            return ('جنوبی')
        } else if (file.east) {
            return ('شرقی')
        } else if (file.west) {
            return ('غربی')
        } else {
            return '';
        }
    }

    function getNoeMelk(file) {

        if (!_.isEmpty(file.office)) {
            return 'دفترکار';
        } else if (!_.isEmpty(file.apartment)) {
            return 'آپارتمان';
        } else if (!_.isEmpty(file.building)) {
            return 'مستغلات';
        } else if (!_.isEmpty(file.oldHouse)) {
            return 'کلنگی';
        } else if (!_.isEmpty(file.land)) {
            return 'زمین';
        } else if (!_.isEmpty(file.vila)) {
            return 'ویلا';
        } else if (file.store) {
            return 'مغازه';
        } else if (file.suite) {
            return 'سوییت';
        } else {
            return '';
        }

    }

    ipcRenderer.on('sendPrintFileFromMain', function (event, file) {
        filePrinted = file;

        document.querySelector('#date').innerHTML = StringUtils.convertMillisecondToShamsi(file.date);
        document.querySelector('#address').innerHTML = !_.isEmpty(file.address) ? file.address : '';
        document.querySelector('#telephone').innerHTML = StringUtils.convertNumbersToPersian(file.tel1);
        document.querySelector('#regionCode').innerHTML = StringUtils.convertNumbersToPersian(file.regionCode);
        document.querySelector('#regionName').innerHTML = file.regionName;
        document.querySelector('#owner').innerHTML = !_.isEmpty(file.owner) ? file.owner : '';
        document.querySelector('#publisher').innerHTML = !_.isEmpty(file.publisher) ? file.publisher : '';
        document.querySelector('#number').innerHTML = file.Id;
        document.querySelector('#direction').innerHTML = getDirection(file);
        document.querySelector('#mored').innerHTML = file.sale;
        document.querySelector('#ageBuilding').innerHTML = file.age ? StringUtils.convertNumbersToPersian(file.age.toString()) : '';
        document.querySelector('#mortgagePrice').innerHTML = file.mortgage ? StringUtils.convertNumbersToPersian(StringUtils.commify(file.mortgage.toString())) : '';
        document.querySelector('#rentPrice').innerHTML = file.rent ? StringUtils.convertNumbersToPersian(StringUtils.commify(file.rent.toString())) : '';
        document.querySelector('#unitPrice').innerHTML = file.unitPrice ? StringUtils.convertNumbersToPersian(StringUtils.commify(file.unitPrice.toString())) : '';
        document.querySelector('#totalPrice').innerHTML = file.totalPrice ? StringUtils.convertNumbersToPersian(StringUtils.commify(file.totalPrice.toString())) : '';
        document.querySelector('#documentKind').innerHTML = !_.isEmpty(file.documentKind) ? file.documentKind : '';
        document.querySelector('#parking').innerHTML = !_.isEmpty(file.unitParking) ? file.unitParking : '';
        document.querySelector('#frontKind').innerHTML = !_.isEmpty(file.frontKind) ? file.frontKind : '';
        document.querySelector('#unitWC').innerHTML = !_.isEmpty(file.unitWC) ? file.unitWC : '';
        document.querySelector('#unitFloorCovering').innerHTML = !_.isEmpty(file.unitFloorCovering) ? file.unitFloorCovering : '';
        document.querySelector('#unitRoom').innerHTML = file.unitRoom ? StringUtils.convertNumbersToPersian(file.unitRoom.toString()) : '';
        document.querySelector('#floorNo').innerHTML = file.floorNo ? StringUtils.convertNumbersToPersian(file.floorNo.toString()) : '';
        document.querySelector('#unitNo').innerHTML = file.unitNo ? StringUtils.convertNumbersToPersian(file.unitNo.toString()) : '';
        document.querySelector('#front').innerHTML = file.front ? StringUtils.convertNumbersToPersian(file.front.toString()) : '';
        document.querySelector('#area').innerHTML = file.area ? StringUtils.convertNumbersToPersian(file.area.toString()) : '';
        document.querySelector('#unitBuiltUpArea').innerHTML = file.unitBuiltUpArea ? StringUtils.convertNumbersToPersian(file.unitBuiltUpArea.toString()) : '';
        document.querySelector('#comment').innerHTML = !_.isEmpty(file.comment) ? file.comment : '';
        document.querySelector('#unitFloor').innerHTML = file.unitFloor ? StringUtils.convertNumbersToPersian(file.unitFloor.toString()) : '';
        document.querySelector('#iphoneImage').innerHTML = file.equipments.includes('ایفون تصویری') ? '✔' : '';
        document.querySelector('#remoteDoor').innerHTML = file.equipments.includes('درب ریموت') ? '✔' : '';
        document.querySelector('#balcony').innerHTML = file.unitBalcony ? '✔' : '';
        document.querySelector('#komodDivari').innerHTML = file.equipments.includes('کمددیواری') ? '✔' : '';
        document.querySelector('#hasTelephon').innerHTML = (!_.isEmpty(file.unitTelephone) && file.unitTelephone !== 'ندارد') ? '✔' : '';
        document.querySelector('#anbari').innerHTML = (!_.isEmpty(file.unitAnbari) && file.unitAnbari !== 'ندارد') ? '✔' : '';
        document.querySelector('#asansor').innerHTML = file.equipments.includes('آسانسور') ? '✔' : '';
        document.querySelector('#pool').innerHTML = file.pool !== 'ندارد' ? '✔' : '';
        document.querySelector('#split').innerHTML = file.equipments.includes('اسپلیت') ? '✔' : '';
        document.querySelector('#koolerGazi').innerHTML = file.equipments.includes('کولر گازی') ? '✔' : '';
        document.querySelector('#gazRoomizi').innerHTML = file.equipments.includes('گاز رومیزی') ? '✔' : '';
        document.querySelector('#package').innerHTML = file.equipments.includes('پکیچ') ? '✔' : '';
        document.querySelector('#shoomine').innerHTML = file.equipments.includes('شومینه') ? '✔' : '';
        document.querySelector('#shoofazh').innerHTML = file.equipments.includes('شوفاژ') ? '✔' : '';
        document.querySelector('#hood').innerHTML = file.equipments.includes('هود') ? '✔' : '';
        document.querySelector('#kabinet').innerHTML = file.equipments.includes('کابینت') ? '✔' : '';
        document.querySelector('#doubleGlazedWindow').innerHTML = file.equipments.includes('پنجره دوجداره') ? '✔' : '';
        document.querySelector('#kaghazDivari').innerHTML = file.equipments.includes('کاغذ دیواری') ? '✔' : '';
        document.querySelector('#securityDoor').innerHTML = file.equipments.includes('درب ضد سرقت') ? '✔' : '';
        document.querySelector('#takhlie').innerHTML = file.empty ? '✔' : '';
        document.querySelector('#ownerInHouse').innerHTML = file.ownerInHouse === 'بله' ? '✔' : '';
        document.querySelector('#yard').innerHTML = file.yard !== 'ندارد' ? '✔' : '';
        document.querySelector('#publisher').innerHTML = file.source;
        document.querySelector('#noeMelk').innerHTML = getNoeMelk(file);
        document.querySelector('#receiver').innerHTML = store.get('realStateName') ? store.get('realStateName') : '';

    });

    var pdf = document.getElementById('btn-convert-pdf');
    pdf.addEventListener('click', (event) => {
        // document.querySelector('body').style.transform = 'scale(1)';
        // document.querySelector('body').style.height = 'auto';

        // document.querySelector('html').style.transform = 'scale(1)';
        // document.querySelector('html').style.height = 'auto';
        ipcRenderer.send('printFile');
    });
</script>
</body>
</html>
