<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=1024, maximum-scale=1.0" />
    <link rel="shortcut icon" type="image/png" href="https://animaproject.s3.amazonaws.com/home/favicon.png" />
    <meta name="og:type" content="website" />
    <meta name="twitter:card" content="photo" />
    <link rel="stylesheet" type="text/css" href="css/phonebook.css" />
    <link rel="stylesheet" type="text/css" href="css/styleguide.css" />
    <link rel="stylesheet" type="text/css" href="css/globals.css" />
    <meta name="author" content="AnimaApp.com - Design to code, Automated." />
    <style>
        @font-face {
            font-family: IRANSansMobileFaNum-Light;
            src: url("./fonts/IRANSansMobileFaNum-Light.eot") format('eot'),
            url("./fonts/IRANSansMobileFaNum-Light.woff") format('woff'),
            url("./fonts/IRANSansMobileFaNum-Light.ttf") format('truetype');
        }

        body::-webkit-scrollbar {
            display: none;
        }

        canvas{

            width:800px !important;
            height:400px !important;

        }

        .chart-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #contacts {
            border-collapse: collapse;
            width: 100%;
            direction: rtl;
            font-family: IRANSansMobileFaNum-Light;
        }

        #contacts td, #contacts th {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        #contacts tr:nth-child(even){background-color: #f2f2f2;}

        #contacts tr:hover {background-color: #ddd;}

        #contacts th {
            padding-top: 12px;
            padding-bottom: 12px;
            background: linear-gradient(180deg, rgba(35, 17, 214, 0.88) 0%, #64d4f2 100%);
            color: white;
            text-align: center;
            border-radius: 5px;
        }

        #loading {
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            position: fixed;
            display: none;
            opacity: 0.7;
            background-color: #fff;
            z-index: 99;
            text-align: center;
        }

        #addTableButton {
            align-self: flex-end;
            margin: 5px;
        }

        .textInput {
            margin-left: 2.5px;
            margin-right: 2.5px;
            width: -webkit-fill-available;
            background-image: linear-gradient(
                    89deg, #130de622, white) !important;
            border-width: 0.5px;
            border-radius: 5px
        }
    </style>
</head>
<body style="margin: 0; background: #f7f7f7; font-family: IRANSansMobileFaNum-Light">
<input type="hidden" id="anPageName" name="page" value="phonebook" />
<div class="container-center-horizontal">
    <div class="phonebook screen">
        <div class="overlap-group-1">
            <div class="icon">
                <div class="overlap-group1">
                    <img class="path-51" src="img/path-51@1x.png" />
                    <div class="mdi-file-restore">
                        <img class="path-file-restore" src="img/path---file-restore-1@1x.png" style="cursor: pointer" onclick="onRestoreContactClick()"/>
                    </div>
                    <div class="mdi-file-search"><img class="path-file-search" src="img/path---file-search@1x.png" style="cursor: pointer" onclick="onSearchContactClick()"/></div>
                </div>
            </div>
            <img class="path-file-plus" src="img/path---file-plus@1x.png" style="cursor: pointer" onclick="addContact()"/>
        </div>
        <div class="jostojo">
            <div class="overlap-group">
                <div class="rectangle-64 border-1px-dove-gray"></div>
                <div class="rectangle-51 border-1px-navy-blue">
                    <table id="contacts">
                        <tr>
                            <th>نام</th>
                            <th>شماره تلفن</th>
                        </tr>
                    </table>
                </div>
                <div class="rectangle border-1px-dove-gray"></div>
                <div class="text-115 iransans-light-white-17px">جستجو مخاطب</div>
                <input class="rectangle-9 border-1px-navy-blue" id="nameSearch"/>
                <input class="rectangle-9-1 border-1px-navy-blue" id="lastnameSearch"/>
                <input class="rectangle-9-2 border-1px-navy-blue" id="companySearch"/>
                <div class="text-116 iransans-light-black-13px">: نام</div>
                <div class="text-117 iransans-light-black-13px">: نام خانوادگی</div>
                <div class="text-118 iransans-light-black-13px">: نام شرکت</div>
            </div>
        </div>
        <div class="sabt">
            <div class="overlap-group">
                <div class="rectangle-65 border-1px-dove-gray"></div>
                <div class="rectangle border-1px-dove-gray"></div>
                <div class="text-119 iransans-light-white-17px">ثبت اطلاعات مخاطب</div>
                <div class="group-11">
                    <input class="rectangle-6 border-1px-navy-blue" id="name"/>
                    <input class="rectangle-6-1 border-1px-navy-blue" id="lastname"/>
                    <input class="rectangle-6-1 border-1px-navy-blue" id="company"/>
                </div>
                <div class="group-12">
                    <input class="rectangle-6 border-1px-navy-blue" id="telephone"/>
                    <input class="rectangle-6-1 border-1px-navy-blue" id="companyTelephone"/>
                    <input class="rectangle-6-1 border-1px-navy-blue" id="mobileNumber"/>
                </div>
                <div class="group-13">
                    <input class="rectangle-6 border-1px-navy-blue" id="email"/>
                    <input class="rectangle-6-1 border-1px-navy-blue" id="website"/>
                </div>
                <input class="rectangle-66 border-1px-navy-blue" id="fax"/>
                <div class="text-120 iransans-light-black-15px">: نام</div>
                <div class="text-121 iransans-light-black-15px">: نام خانوادگی</div>
                <div class="text-122 iransans-light-black-15px">: نام شرکت</div>
                <div class="text-123 iransans-light-black-15px">: تلفن</div>
                <div class="text-124 iransans-light-black-15px">: تلفن شرکت</div>
                <div class="text-125 iransans-light-black-15px">: فکس</div>
                <div class="text-126 iransans-light-black-15px">: ایمیل</div>
                <div class="text-127 iransans-light-black-15px">:وب سایت</div>
                <div class="text-128 iransans-light-black-15px">: موبایل</div>
            </div>
        </div>
    </div>
</div>
<script>
    const electron = require('electron');
    const {ipcRenderer} = electron;
    const _ = require('underscore');
    const Store = require('electron-store');
    const store = new Store();
    var contactList = !_.isEmpty(store.get('contactList')) ? store.get('contactList') : [];
    var showContactTitle = [
        {key: 'name', value: 'نام'},
        {key: 'telephone', value: 'شماره تلفن'}
    ];
    const { remote } = require('electron');
    const { Menu } = remote;

    const markdownContextMenu = Menu.buildFromTemplate([
        { type: 'separator' },
        { label: 'Cut', role: 'cut' },
        { label: 'Copy', role: 'copy' },
        { label: 'Paste', role: 'paste' },
        { label: 'Select All', role: 'selectall' },
    ]);

    document.addEventListener('contextmenu', (event) => {
        event.preventDefault();
        markdownContextMenu.popup();
    });

    function onRestoreContactClick() {
        remote.getCurrentWindow().reload();
    }

    function onSearchContactClick() {
        var nameSearch = document.getElementById('nameSearch').value;
        var lastnameSearch = document.getElementById('lastnameSearch').value;
        var companySearch = document.getElementById('companySearch').value;
        var tableContent = document.getElementById("contacts");
        tableContent.innerHTML = '';
        var newContactList = contactList.filter(contact => ((contact.name) && (contact.name).includes(nameSearch)) &&
            ((contact.lastname) && (contact.lastname).includes(lastnameSearch)) &&
            ((contact.company) && (contact.company).includes(companySearch)));

        for (var i = 0, n = newContactList.length; i < n; i++) {
            var rowContainer = document.createElement("TR");
            for (var j = 0, k = showContactTitle.length; j < k; j++) {
                var columnContainer = document.createElement("TD");
                columnContainer.innerHTML = newContactList[i][showContactTitle[j].key];
                rowContainer.appendChild(columnContainer);
            }
            rowContainer.id = i;
            rowContainer.onclick = function () {
                ipcRenderer.send('contactInfo', contactList[parseInt(this.id)]);
            };
            tableContent.appendChild(rowContainer);
        }
    }

    var tableContent = document.getElementById("contacts");

    for (var i = 0, n = contactList.length; i < n; i++) {
        var rowContainer = document.createElement("TR");
        for (var j = 0, k = showContactTitle.length; j < k; j++) {
            var columnContainer = document.createElement("TD");
            columnContainer.innerHTML = contactList[i][showContactTitle[j].key];
            rowContainer.appendChild(columnContainer);
        }
        rowContainer.id = i;
        rowContainer.onclick = function () {
            ipcRenderer.send('contactInfo', contactList[parseInt(this.id)]);
        };
        tableContent.appendChild(rowContainer);
    }

    function addContact() {
        var name = document.getElementById('name').value;
        var telephone = document.getElementById('telephone').value;
        var lastname = document.getElementById('lastname').value;
        var company = document.getElementById('company').value;
        var companyTelephone = document.getElementById('companyTelephone').value;
        var mobileNumber = document.getElementById('mobileNumber').value;
        var email = document.getElementById('email').value;
        var website = document.getElementById('website').value;
        ipcRenderer.send('addToContactList', {name, telephone, lastname, company, companyTelephone, mobileNumber, email, website});
    }
</script>
</body>
</html>
